---
title: 第十六讲——模块一
id: 16
date: 2019-8-4 20:00:00
tags: Python
comment: true
---

### 学习大纲

- 自定义模块
- time模块
- datetime模块
- random模块
- 练习
-具体模块内容见blog：https://blog.csdn.net/qq_40890660/article/details/98214433

<!-----more----->

### 自定义模块

一、模块时什么？

- 一个函数封装一个文件中，当多个一些常用的函数封装到一个文件中，那么这个储存着很多常用功能的py文件就是模块。模块就是一些常用功能的集合。

二、模块分类

- 内置模块（标准库）--python解释器自带的，可以直接导入的
- 第三方模块 （大神写的） --通过pip install下载的
- 自定义模块 

三、模块的好处

- 避免写重复代码，从文件级别组织程序，更方便管理 随着程序的发展，功能越来越多，为了方便管理，我们通常将程序分成一个个的文件，这样做程序的结构更清晰，方便管理。这时我们不仅仅可以把这些文件当做脚本去执行，还可以把他们当做模块来导入到其他的模块中，实现了功能的重复利用。
- 拿来主义，提升开发效率 同样的原理，我们也可以下载别人写好的模块然后导入到自己的项目中使用，这种拿来主义，可以极大地提升我们的开发效率，避免重复造轮子。

四、导入模块发生了哪些事情：

- 创建一个以模块名命名的名称空间。
- 将这个模块中所有的代码执行一遍。
- 通过模块名.的方式引入该模块里面的内容（变量，函数名，类名等）。
- 注：重复导入会引用内存中已经加载好的结果。

五、将模块命别名

- import 模块名 as 别名
- 起别名的好处：当模块名字很长的时候，方便记和使用；同时有利于代码的扩展和优化。

六、import和from...import的区别

- import是把模块里面的东西全部拿过来

  - 缺点：占用内存比较大
  - 优点：不会和当前文件定义的变量或者函数发生冲突

- from...import模块就是进入模块内部去只拿自己想要的东西

  - 缺点：会和当前文件定义的变量或者函数发生冲突(解决办法：起别名)
  - 优点：占用的内存小

- 实例

```python
import：  
      import test
         name = "pl"
         print(test.name)
         print(name)

from :
         name = "pl"
         from test import name
         print(name)

        # 解决方法:
            name = "pl"
            from test import name as n
            print(name)
            print(n)

```

七、导入模块的三种方式

1. import xxx
2. from xxx  import xxx
3. from xxx import *  (不推荐使用这种方式导入模块)

八、py文件的的两种用法

- 脚本（在cmd中执行的py文件）
- 模块

```python
python为我们内置了全局变量__name__，
   当文件被当做脚本执行时：__name__ 等于'__main__'
   当文件被当做模块导入时：__name__等于模块名
#这也是我们用来在不同的py文件场景下执行不同的逻辑。
```

九、if __name__ == '__main__':   #测试接口

- 在当前模块中使用__name__就是__main__
- 在模块被导入 的时候__name__就是被导入的模块名

十、模块的查找顺序

   ```python
   #内存中已经加载的模块->内置模块->sys.path路径中包含的模块
   模块的查找顺序
       1,在第一次导入某个模块时（比如tbjx），会先检查该模块是否已经被加载到内存中（当前执行文件的名称空间对应的内存），如果有则直接引用（ps：python解释器在启动时会自动加载一些模块到内存中，可以使用sys.modules查看）
       2,如果没有，解释器则会查找同名的内置模块
       3,如果还没有找到就从sys.path给出的目录列表中依次寻找tbjx.py文件。
   #需要特别注意的是：我们自定义的模块名不应该与系统内置模块重名。
   ```

十一、导入路径

- 相对路径

- 绝对路径

- 实例

```python
#使用相对路径:
from day15.t1 import meet
print(meet.name)

# 正确的绝对路径:
from sys import path
path.insert(0,"D:\\")
import meet
print(meet.name)
```

### time模块

```python
import time
print (time.time())  #时间戳  浮点数
#1564041048.1111746
time.sleep(1)  #睡眠 阻塞
print(time.strftime("%Y-%m-%d %H:%M:%S"))
#2019-07-25 15:52:32
print (time.gmtime())  #结构化时间 数据类型是命名元组
#time.struct_time(tm_year=2019, tm_mon=7, tm_mday=25, tm_hour=7, tm_min=53, tm_sec=15, tm_wday=3, tm_yday=206, tm_isdst=0)

#将时间戳转化为字符串时间
print (time.strftime("%Y-%m-%d %H:%M:%S",time.gmtime(1564028611.631374)))
#2019-07-25 04:23:31
#将字符串时间转化成时间戳
print (time.mktime(time.strptime("2024-3-16 12:30:30","%Y-%m-%d %H:%M:%S")))
#1710563430.0
```

### datatime模块

```python
print (datetime.now())  #获取当前时间
#2019-07-25 15:57:38.599890
print(datetime(2019, 5, 20, 15, 14, 00)) #转化格式
#2019-05-20 15:14:00
#将当前时间转化成时间戳
print (datetime.now().timestamp())
#1564041586.28922
#将时间戳转化成当前时间
print (datetime.fromtimestamp(13543443435))
#2399-03-06 03:37:15
#将字符串转化成象
print (type(datetime.strptime("2019-10-10 22:23:24","%Y-%m-%d %H:%M:%S")))
#<class 'datetime.datetime'>
#将对象转化成字符串
print (type(datetime.now().strftime("%Y-%m-%d %H:%M:%S")))
#<class 'str'>
#datetime加减
print(datetime.now() + timedelta(hours=30*24*12))
#2020-07-19 16:05:25.403830
print(datetime.now() - timedelta(hours=30 * 24 * 12))
#2018-07-30 16:06:14.273110
#总结：记录日志使用和计算时间
```

### random模块

```python
print (random.random())  #0~1  浮点
# 0.8059617097306809
print (random.uniform(1,10)) #1-10  浮点
# 1.8943544182817131
print (random.randint(1,50)) #1-50
#22
print (random.randrange(1,30,2))  #(起始，终止，步长)
#5
print(random.choice([1,2,3,563,13,654,6413,1,3,131]))  #随机选择一个元素
#131
print (random.choices([1,51,1313,15,331,321,1313],k=2)) #随机选择多个元素，会有重复，返回列表
#[1313, 331]
print(random.sample((12,22,31,12,212,1,231,212,12,12,1,2,12,1,21,),k=3))#随机选择多个元素，不会有重复，返回列表
#[231, 1, 12]

lst = [1,2,3,4,5,6,7,8,9,0]
random.shuffle(lst)  # 顺序打乱
print (lst)
```
### 练习

```python
#作业
# 2.写函数：用户输入某年某月，判断这是这一年的第几天（需要用Python的结构化时间）。
# 结构化时间可以通过这样取值：
# while True:
# 	now_time = input("请输入现在的时间（格式：2019-1-1）：")
# 	if  list(now_time.split("-")).__len__() == 3:
# 		s = time.mktime(time.strptime(now_time,"%Y-%m-%d"))
# 		ret = time.gmtime(s)
# 		#print(ret)  # time.struct_time(tm_year=2019, tm_mon=6, tm_mday=28, tm_hour=15, tm_min=50, tm_sec=47, tm_wday=4, tm_yday=179, tm_isdst=0)
# 		print(f"{now_time}是今年的第{ret.tm_yday}天。")  # 2019
# 		break
# 	else:
# 		print("时间的格式输入错误，请重新输入。")
```

```python
# 3.用户输入一个"2019-7-26 20:30:30"和当前时间相比
# ,一共过去了多少年多少月多少天到少小时多少分钟


s = datetime.strptime("2019-7-28 20:30:30",'%Y-%m-%d %H:%M:%S')
a  = datetime.now()
w = str(a - s)
print (w)
if "," in w:
	day = w.split(",")[0].split(" ")[0]
	hou = w.split(",")[-1].split(":")[0]
	min = w.split(",")[-1].split(":")[1]
	sec = w.split(",")[-1].split(":")[2].split(".")[0]
else:
	day = 0
	hou = w.split(",")[-1].split(":")[0]
	min = w.split(",")[-1].split(":")[1]
	sec = w.split(",")[-1].split(":")[2].split(".")[0]
if int(day) >= 0:
	year = int(day)//365
	mon = (int(day) - year*365) // 30
	real_day = int(day) - year*365 - mon*30
	print (f"一共过去了{year}年{mon}月{real_day}天{hou}小时{min}分钟")
else:
	year = -int(day)//365
	mon = -(int(day) - year*365) // 30
	real_day = -int(day) - year*365 - mon*30
	print (f"一共过去了{-year}年{-mon}月{-real_day+1}天{24-int(hou)}小时{60-int(min)}分钟")
```

```python
#4.写函数，生成一个4位随机验证码（包含数字大小写字母)
def foo():
	code = ""
	for i in range(4):
		curtten = random.randint(0,4)
		if curtten == i:
			temp = random.choice([chr(random.randint(65,90)),chr(random.randint(97,122))])
		else:
			temp  = random.randint(0,9)
		code += str(temp)
	print (f"验证码是{code}")
foo()
```

