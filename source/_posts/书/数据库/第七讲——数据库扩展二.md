---
title: 第七讲——数据库扩展二之数据库之间的对比与选择
id: 7
date: 2019-9-6 20:00:00
tags: mysql
comment: true
---

### Nosql

**优点：**
1）成本：nosql数据库简单易部署，基本都是开源软件，不需要像使用oracle那样花费大量成本购买使用，相比关系型数据库价格便宜。
2）查询速度：nosql数据库将数据存储于缓存之中，关系型数据库将数据存储在硬盘中，自然查询速度远不及nosql数据库。
3）存储数据的格式：nosql的存储格式是key,value形式、文档形式、图片形式等等，所以可以存储基础类型以及对象或者是集合等各种格式，而数据库则只支持基础类型。
4）扩展性：关系型数据库有类似join这样的多表查询机制的限制导致扩展很艰难。
**缺点：**
1）维护的工具和资料有限，因为nosql是属于新的技术，不能和关系型数据库10几年的技术同日而语。
2）不提供对sql的支持，如果不支持sql这样的工业标准，将产生一定用户的学习和使用成本。
3）不提供关系型数据库对事物的处理。

<!----more---->

### SQL

**优势：**

1）复杂查询可以用SQL语句方便的在一个表以及多个表之间做非常复杂的数据查询。

2）事务支持使得对于安全性能很高的数据访问要求得以实现。对于这两类数据库，对方的优势就是自己的弱势，反之亦然。

**缺点：**

1）大量数据的写入处理。

2）为有数据更新的表做索引或表结构（schema）变更。

3）字段不固定时应用。

4）对简单查询需要快速返回结果的处理。

**分析：**

--大量数据的写入处理

读写集中在一个数据库上让数据库不堪重负，大部分网站已使用主从复制技术实现读写分离，以提高读写性能和读库的可扩展性。

所以在进行大量数据操作时，会使用数据库主从模式。数据的写入由主数据库负责，数据的读入由从数据库负责，可以比较简单地通过增加从数据库来实现规模化，但是数据的写入却完全没有简单的方法来解决规模化问题。

第一，要想将数据的写入规模化，可以考虑把主数据库从一台增加到两台，作为互相关联复制的二元主数据库使用，确实这样可以把每台主数据库的负荷减少一半，但是更新处理会发生冲突，可能会造成数据的不一致，为了避免这样的问题，需要把对每个表的请求分别分配给合适的主数据库来处理。

第二，可以考虑把数据库分割开来，分别放在不同的数据库服务器上，比如将不同的表放在不同的数据库服务器上，数据库分割可以减少每台数据库服务器上的数据量，以便减少硬盘IO的输入、输出处理，实现内存上的高速处理。但是由于分别存储字不同服务器上的表之间无法进行Join处理，数据库分割的时候就需要预先考虑这些问题，数据库分割之后，如果一定要进行Join处理，就必须要在程序中进行关联，这是非常困难的。


--为有数据更新的表做索引或表结构变更

在使用关系型数据库时，为了加快查询速度需要创建索引，为了增加必要的字段就一定要改变表结构，为了进行这些处理，需要对表进行共享锁定，这期间数据变更、更新、插入、删除等都是无法进行的。如果需要进行一些耗时操作，例如为数据量比较大的表创建索引或是变更其表结构，就需要特别注意，长时间内数据可能无法进行更新。

--字段不固定时的应用

如果字段不固定，利用关系型数据库也是比较困难的，有人会说，需要的时候加个字段就可以了，这样的方法也不是不可以，但在实际运用中每次都进行反复的表结构变更是非常痛苦的。你也可以预先设定大量的预备字段，但这样的话，时间一长很容易弄不清除字段和数据的对应状态，即哪个字段保存有哪些数据。

--对简单查询需要快速返回结果的处理  （这里的“简单”指的是没有复杂的查询条件）

这一点称不上是缺点，但不管怎样，关系型数据库并不擅长对简单的查询快速返回结果，因为关系型数据库是使用专门的sql语言进行数据读取的，它需要对sql与越南进行解析，同时还有对表的锁定和解锁等这样的额外开销，这里并不是说关系型数据库的速度太慢，而只是想告诉大家若希望对简单查询进行高速处理，则没有必要非使用关系型数据库不可。



### 数据库的分类

##### 关系型数据库

**mysql**：5千万以上

特点：

1.其体积小；

2.总体拥有成本低；

3.开放源码；

4.可运行在Windows平台和大多数的Linux平台上；

5.快速，轻量级，易于扩展，免费，跨平台；

6.可以同时处理几乎不限数量的用户；

7.处理多达50,000,000以上的记录；

8.命令执行速度快，也许是现今最快的；

9.简单有效的用户特权系统。

**优点：**

1.使用C和C++编写，并使用了多种编译器进行测试，保证源代码的可移植性；

2.支持AIX、FreeBSD、HP-UX、Linux、Mac OS、NovellNetware、OpenBSD、OS/2 Wrap、Solaris、Windows等多种操作系统；

3.为多种编程语言提供了API。这些编程语言包括C、C++、Python、Java、Perl、PHP、Eiffel、Ruby和Tcl等；

4.支持多线程，充分利用CPU资源；

5.价格便宜：Mysql是开源的，所以不需要支付额外的费用；

6.MySQL使用标准的SQL数据语言形式；

7.Mysql对PHP有很好的支持，PHP是目前最流行的Web开发语言。

**缺点：**

1.比较难学；

2.MySQL也缺乏一些存储程序的功能；

3.使用缺省的ip端口，但是有时候这些ip也会被一些黑客闯入；

4.使用myisam配置，如果你不慎损坏数据库，结果可能会导致所有的数据丢失。

**应用场景：**

广泛地应用在Internet上的中小型网站中

LAMP（Linux+Apache+Mysql+Php）

mysql的优势在于免费，如果业务系统数据库不是极其庞大，可用mysql



**sql server**：百万级

**优势：**

1.安全性和可用性高；

2.超快的性能；

3.企业安全性；

4.快速的数据发现；

5.方便易用；

6.高效的数据压缩功能；

7.集成的开发环境。

**缺点：**

1.开放性。只能运行在微软的windows平台，没有丝毫的开放性可言；

2.可伸缩性，并行性。并行实施和共存模型并不成熟，很难处理日益增多的用户数和数据卷，伸缩性有限；

3.性能稳定性。SQLServer当用户连接多时性能会变的很差，并且不够稳定；

4.使用风险。SQLServer完全重写的代码，经历了长期的测试，不断延迟，许多功能需时间来证明。并不十分兼容早期产品。使用需要冒一定风险；

5.客户端支持及应用模式。只支持C/S模式；

6.安全性。Oracle的安全认证获得最高认证级别的ISO标准认证，而SQL Server并没有获得什么安全认证。

**使用场景：**

主机操作系统为window，主要用于web网站的建设，承载中小型web后台数据。在租赁的虚拟主机中一般会预安装SQL Server作为数据库软件。

**DB2**

**优点：**

1.能在所有主流平台上运行（包括windows）。最适于海量数据；

2.具有很好的并行性。DB2把数据库管理扩充到了并行的、多节点的环境；

3.获得最高认证级别的ISO标准认证；

4.客户端支持及应用模式；

5.跨平台，多层结构，支持ODBC，JDBC等客户；

6.操作简单，同时提供GUI和命令行，在windowsNT和unix下操作相同。

**缺点：**

1.在巨型企业得到广泛的应用，向下兼容性好。风险小。

**使用场景：**

性能较高适用于数据仓库和在线事物处理。DB2 超大型数据库，与ORACLE类似 ，数据仓库和数据挖掘相当的不错，特别是集群技术可以使DB2的可扩性能达到极致。





##### 非关系型数据库

**redis**

**特点：**Redis是一个key-value存储系统,key为字符串类型，只能通过key对value进行操作，支持的数据类型包括string、list、set、zset(有序集合)和hash。Redis支持主从同步，数据可以从主服务器向任意数量的从服务器上同步。

​    Redis事务允许一组命令在单一步骤中执行。事务有两个属性：在一个事务中的所有命令作为单个独立的操作顺序执行；Redis事务是原子的，原子意味着要么所有的命令都执行，要么都不执行。Redis 事务由指令 MULTI 发起的，之后传递需要在事务中和整个事务中，最后由 EXEC 命令执行所有命令的列表。

**优势：**

是将数据分割成多个 Redis 实例，使每个实例将只包含键子集的过程.它允许更大的数据库，使用多台计算机的内存总和,它允许按比例在多内核和多个计算机计算，以及网络带宽向多台计算机和网络适配器。

**缺点：**

涉及多个键时，Redis事务无法使用；数据处理比较复杂；加和删除的容量可能会很复杂。

**应用：**

统计

![](http://9017499461.linshutu.top/redis.png)

**mongodb**

 **介绍**一个基于分布式文件存储的开源数据库系统，为WEB应用提供可扩展的高性能数据存储解决方案。MongoDB 将数据存储为一个文档，数据结构由键值(key value)对组成。

**特点：**

 面向集合存储，易存储对象类型的数据；模式自由；支持动态查询；支持完全索引，包含内部对象；支持查询；支持复制和故障恢复；使用高效的二进制数据存储，包括大型对象（如视频）；自动处理碎片，以支持云计算层次的扩展性；支持RUBY，PYTHON，JAVA，C++，PHP，C#等多种语言；文件存储格式为BSON（一种JSON的扩展）；可通过网络访问。

**应用场景：**

网站数据；缓存；大尺寸，低价值的数据；高伸缩性的场景；用于对象及JSON 数据的存储。

![](http://9017499461.linshutu.top/mongodb.png)